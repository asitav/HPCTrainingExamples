{
  "version": "v2_fused",
  "timestamp": "20251120_173647",
  "config": {
    "vocab_size": 21,
    "msa_dim": 64,
    "pair_dim": 128,
    "n_evoformer_blocks": 4,
    "n_heads_msa": 4,
    "n_heads_pair": 4,
    "msa_intermediate_dim": 256,
    "pair_intermediate_dim": 512,
    "outer_product_dim": 32,
    "max_seq_len": 64,
    "n_seqs": 16,
    "pair_input_dim": 65,
    "dropout": 0.0,
    "norm_eps": 1e-05
  },
  "fusion_config": {
    "enable_qkv_fusion_msa": true,
    "enable_qkv_fusion_triangle": true,
    "enable_flash_attention": true,
    "enable_triangle_fusion": true,
    "enable_torch_compile": false,
    "flash_attention_dropout": 0.0,
    "torch_compile_mode": "default",
    "torch_compile_dynamic": false
  },
  "profiler_config": {
    "enable_pytorch_profiler": false,
    "enable_deepspeed_flops": false,
    "enable_memory_profiling": false,
    "enable_rocm_profiling": false,
    "profile_operators": false,
    "profile_dir": "./pytorch_profiles_v2",
    "sort_by": "cuda_time_total",
    "warmup_steps": 3,
    "profile_steps": 5,
    "export_chrome_trace": true,
    "export_stacks": false,
    "rocm_trace_kernels": true,
    "rocm_trace_hip": true
  },
  "performance_summary": {
    "total_samples": 200,
    "avg_training_speed": 107.04194005949452,
    "avg_loss": 33.28817756652832,
    "avg_batch_time": 0.03736886024475097,
    "avg_forward_time": 0.014985127449035645,
    "avg_backward_time": 0.01912116527557373,
    "avg_optimizer_time": 0.0032625675201416017,
    "peak_memory_mb": 195.66748046875,
    "avg_memory_mb": 195.66748046875,
    "fusion_statistics": {
      "avg_qkv_fusion_msa_enabled": 1.0,
      "avg_qkv_fusion_triangle_enabled": 1.0,
      "avg_flash_attention_enabled": 1.0,
      "avg_triangle_fusion_enabled": 1.0,
      "avg_torch_compile_enabled": 0.0,
      "avg_baseline_kernels_per_block": 15.0,
      "avg_fused_kernels_per_block": 3.0,
      "avg_kernel_reduction_per_block": 12.0,
      "avg_total_kernel_reduction": 48.0,
      "avg_kernel_reduction_percent": 80.0
    }
  },
  "fusion_statistics": {
    "qkv_fusion_msa_enabled": true,
    "qkv_fusion_triangle_enabled": true,
    "flash_attention_enabled": true,
    "triangle_fusion_enabled": true,
    "torch_compile_enabled": false,
    "baseline_kernels_per_block": 15,
    "fused_kernels_per_block": 3,
    "kernel_reduction_per_block": 12,
    "total_kernel_reduction": 48,
    "kernel_reduction_percent": 80.0
  },
  "training_params": {
    "num_steps": 50,
    "batch_size": 4,
    "learning_rate": 0.0003,
    "use_amp": false
  },
  "system_info": {
    "device": "cuda",
    "gpu_name": "AMD Instinct MI300X",
    "pytorch_version": "2.9.1+rocm6.4",
    "rocm_version": "N/A",
    "flash_attention_available": true,
    "torch_compile_available": true,
    "timestamp_iso": "2025-11-20T17:36:47.443116"
  }
}